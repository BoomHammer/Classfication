project_name: "SITS_LandCover_Classification"
experiment_id: "EXP_2023_001"

# 1. 输入输出路径 (I/O Paths)
paths:
  data_dir: "../data/"
  csv_labels: "../data/raw/traindata20250626ori.csv"         # 标签CSV文件路径
  static_images_dir: "../data/raster/static/"     # 静态数据（如DEM）文件夹
  dynamic_images_dir: "../data/raster/dynamic/"   # 动态数据（如NDVI、MOD09A1、Sentinel-2）文件夹
  output_dir: "../experiments/outputs/"           # 模型权重与日志保存路径
  temp_dir: "../data/temp/"                       # 临时缓存与中间文件

# 2. 数据规范 (Data Specifications)
data_specs:
  csv_columns:                                    # 映射用户CSV的列名
    id: "Index"
    longitude: "X"
    latitude: "Y"
    major_class: "Formation"
    detail_class: "Alliance"
  
  spatial:
    csv_crs: "auto"                               # CSV 坐标系：'auto' 自动检测，或指定 EPSG 代码
    raster_crs: "auto"                            # 栅格坐标系：'auto' 自动检测，或统一使用的 EPSG 代码
    target_crs: "EPSG:4326"                       # 目标处理坐标系（自动检测失败时使用此值）
    auto_reproject: false                         # 是否自动重投影到目标坐标系（仅当源坐标系不一致时）
    patch_size: 16                                # 训练切片大小 (默认64x64像素)
    resolution: 250.0                              # 影像重采样分辨率 (米)
  
  temporal:
    pad_value: 0.0                                # 时间序列缺失时的填充值
    missing_value_strategy: "forward_fill"        # 缺失值处理：'zero_padding', 'linear_interpolation', 'forward_fill'
    normalization_method: "zscore"                # 归一化方法：'zscore', 'minmax', 'none'
  
  raster_crawler:
    filename_pattern: 'GPP(?P<year>\d{2})(?P<month>\d{2})(?P<day>\d{2})'  # 正则表达式解析文件名
    file_extensions: ['.tif', '.tiff', ]   # 要扫描的文件后缀
    lazy_loading: true                            # 使用懒加载（仅读取元数据）
    build_rtree_index: true                       # 构建 R-树空间索引

# 3. 模型架构参数 (Model Architecture)
model:
  name: "DSSTFN"                           # 模型名称
  # ⚠️ 以下参数将在运行时自动检测，不应手动设置
  # in_channels_dynamic: 由 RasterCrawler 自动检测
  # in_channels_static: 由 RasterCrawler 自动检测
  # num_classes: 由 LabelEncoder 自动检测
  temporal_encoder: "LTAE"                        # 时间编码器类型
  dropout: 0.1                                   # 正则化：增强到0.3以提高小类的稳定性
  # hidden_dim: 256                                  # 隐层维度
  label_smoothing: 0.01                           # 保守的标签平滑（对小类特别重要，避免梯度混乱）
  
  # 分类器隐藏层配置（可灵活调整）
  classifier:
    hidden_dims: [128, 64, 32]                    # 隐藏层维度序列：depth=3, 128->64->32->num_classes

# 4. 训练超参数 (Training Hyperparameters)
train:
  # 通用配置
  seed: 42
  num_workers: 8          # 数据加载线程数，根据CPU核数调整
  split_ratio: [0.7, 0.15, 0.15] # 训练/验证/测试比例
  
  # ========== K-Fold 交叉验证配置 (Stratified K-Fold) ==========
  # 用于小数据集，充分利用每条数据的宝贵信息
  # 注意：K-Fold 始终启用，所有模型均使用 Stratified K-Fold 训练
  kfold:
    n_splits: 5                  # K 折数 (推荐: 3-10, 小数据集推荐5-10)
    random_state: 42             # 随机种子，确保可重复性
    shuffle: true                # 是否在分割前打乱数据
    # Ensemble 预测配置
    ensemble:
      enabled: true              # 启用 Ensemble 投票预测
      method: "voting"           # 预测方法：'voting'（多数投票）或 'averaging'（概率平均）
  # ============================================================

  # === 大类模型专用超参数 ===
  major_model:
    epochs: 400            # 大类通常数据多，训练轮数可以适中
    batch_size: 64        # 显存允许的情况下尽量大
    learning_rate: 0.0005
    weight_decay: 0.0001  # 从0.001->0.0001：更温和的L2正则化
    patience: 25          # 从20->25：给予更多耐心
    use_class_weights: true  # 使用类别权重平衡
    use_sample_resampling: true  # 启用样本重采样
    label_smoothing: 0.01  # 降低标签平滑强度：0.01（保守）

  # === 小类模型专用超参数 ===
  detail_model:
    epochs: 300            # 小类可能需要更多轮次来拟合细节
    batch_size: 32        # 某些小类样本少，Batch Size 不宜过大
    learning_rate: 0.0003 # 从0.0005->0.0003：更保守的学习率
    weight_decay: 0.00005 # 从0.0001->0.00005：更温和的正则化
    patience: 20          # 从15->20：给更多耐心
    min_samples: 5        # 训练所需的最小样本数，少于此数跳过训练
    use_class_weights: true  # 使用类别权重平衡
    use_sample_resampling: true  # 启用样本重采样
    label_smoothing: 0.01  # 降低标签平滑强度：0.01（保守）