"""
config_template.yaml - 训练配置模板参考

本文件展示了所有可用的配置选项及其含义。
可用于快速自定义训练参数。

使用方法：
  1. 复制此文件为 config_custom.yaml
  2. 修改需要的参数
  3. python train.py --config config_custom.yaml

"""

# ============================================================================
# 【训练配置】- train 部分
# ============================================================================

train:
  # 批大小（Batch Size）
  # - 越大：训练越快，但内存占用越多，梯度信号越稳定
  # - 越小：内存占用少，但训练不稳定，更新频繁
  # 推荐：32（在 24GB GPU 上）
  batch_size: 32

  # 学习率（Learning Rate）
  # - 太大：容易发散（Loss 为 NaN）
  # - 太小：收敛太慢
  # 推荐范围：[1e-4, 1e-2]
  # 典型值：1e-3
  learning_rate: 1e-3

  # 权重衰减（L2 正则化）
  # - 防止过拟合
  # - 推荐：1e-4 到 1e-3
  weight_decay: 1e-4

  # 早停耐心数（Patience）
  # - 若此数量的 epoch 验证指标无改进，停止训练
  # - 推荐：5-20，取决于数据集大小
  patience: 10

  # 训练轮数（Epochs）
  # - 推荐：50-100
  # - Debug 模式下自动设为 10
  epochs: 50

  # 数据划分比例（Train / Val / Test）
  # - 比例之和必须为 1.0
  split_ratio: [0.7, 0.15, 0.15]

  # 随机种子（Reproducibility）
  # - 固定此值可重现结果
  seed: 42

  # 数据加载线程数（Num Workers）
  # - 0：关闭多进程加载（慢但稳定）
  # - N：使用 N 个进程并行加载
  # - 推荐：根据 CPU 核心数，通常 4-8
  # 注意：多进程在某些系统上可能不稳定
  num_workers: 0


# ============================================================================
# 【模型配置】- model 部分
# ============================================================================

model:
  # 隐层维度
  # - 动态流 CNN 的中间通道数
  # - 推荐：32, 64, 128
  # - 更大 → 更强表达力但参数多，易过拟合
  hidden_dim: 64

  # 融合层维度
  # - 特征融合后的向量维度
  # - 推荐：64, 128, 256
  fusion_dim: 128

  # Dropout 概率
  # - 防止过拟合
  # - 推荐范围：[0.1, 0.5]
  # - 数据少时用大值，数据多时用小值
  dropout: 0.2


# ============================================================================
# 【数据配置】- data_specs 部分
# ============================================================================

data_specs:
  
  # 空间配置
  spatial:
    # 图块大小（Patch Size）
    # - 64x64 像素
    # - 固定值，不建议改变
    patch_size: 64
  
  # 时间配置
  temporal:
    # 时间步数（固定 12 个月）
    temporal_steps: 12
    
    # 缺失值处理策略
    # - 'zero_padding': 缺失月份填 0
    # - 'linear_interpolation': 线性插值
    # - 'forward_fill': 前向填充
    missing_value_strategy: 'zero_padding'
    
    # 归一化方法
    # - 'zscore': Z-Score 标准化 (x - mean) / std
    # - 'minmax': MinMax 归一化 (x - min) / (max - min)
    # - 'none': 不归一化
    normalization_method: 'zscore'
  
  # 栅格爬虫配置
  raster_crawler:
    # 文件名模式（正则表达式）
    # - 用于自动解析影像文件中的时间信息
    # 示例：GPP230101 → year=23, month=01, day=01
    filename_pattern: 'GPP(?P<year>\d{2})(?P<month>\d{2})(?P<day>\d{2})'
    
    # 支持的文件扩展名
    file_extensions: ['.tif', '.tiff', '.jp2']


# ============================================================================
# 【优化建议】
# ============================================================================

optimization_tips: |
  
  【快速过拟合测试】
  如果想快速验证模型可以学习：
    python train.py --debug
  
  【优化从小到大】
  1. 先用 small_lr + small_batch 确保能训练
  2. 逐步增加 batch_size 加速
  3. 调整学习率找最佳值
  4. 尝试不同的 hidden_dim、dropout
  
  【处理过拟合】
  - 增加 dropout
  - 增加 weight_decay
  - 减少 hidden_dim
  - 增加早停 patience
  
  【处理欠拟合】
  - 减少 dropout
  - 减少 weight_decay
  - 增加 hidden_dim
  - 增加学习率
  - 增加训练 epochs
  
  【显存溢出】
  - 减少 batch_size
  - 减少 hidden_dim
  - 设置 num_workers = 0
  
  【训练太慢】
  - 增加 batch_size（显存允许）
  - 增加 num_workers
  - 检查数据加载延迟（I/O 瓶颈）

"""

print(__doc__)
